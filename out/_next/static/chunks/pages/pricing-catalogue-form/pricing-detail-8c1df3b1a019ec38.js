(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[296],{3525:(e,d,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/pricing-catalogue-form/pricing-detail",function(){return r(5549)}])},5204:(e,d,r)=>{"use strict";r.d(d,{A:()=>l});var i=r(4848);r(6540);var t=r(8331);let l=e=>{let{title:d,children:r,maxWidth:l=1200,fullWidth:s=!1}=e;return(0,i.jsx)(t.A,{title:d,bordered:!1,style:{width:"100%",maxWidth:s?"100%":l,margin:"0 auto",transition:"max-width 0.2s ease-in-out"},children:r})}},5549:(e,d,r)=>{"use strict";r.r(d),r.d(d,{default:()=>u});var i=r(4848),t=r(6540),l=r(8728),s=r(6740),n=r(1531),a=r(3608),o=r(1027),c=r(5204),p=r(1609),x=r(3093),h=r(6715);let{Option:g}=l.A,u=()=>{var e,d;let{pricingCategory:r}=(0,h.useRouter)().query,[u,y]=(0,t.useState)(""),[b,j]=(0,t.useState)([]),[f,m]=(0,t.useState)({}),[A,w]=(0,t.useState)(!1),[C,v]=(0,t.useState)(!1),[k]=s.A.useForm(),[T,S]=(0,t.useState)(null),[q,N]=(0,t.useState)(!1),[E,_]=(0,t.useState)(null),[P,F]=(0,t.useState)(null),R=async()=>{try{let e=await fetch("".concat("http://192.168.0.104:5216/api","/pricingcategories"));if(e.ok){let d=await e.json();j(d)}else console.error("Failed to fetch services:",e.statusText)}catch(e){console.error("Error fetching services:",e)}},I=async()=>{try{let e={};for(let d of b){let r=await fetch("".concat("http://192.168.0.104:5216/api","/tiers/pricingcategory/").concat(d.id));if(r.ok){let i=await r.json();e[d.id]=i.map(e=>({tier:"Tier ".concat(e.tierNumber),quality:e.qualityRange,credit:e.creditPerUnit}))}else console.error("Failed to fetch tiers for service ".concat(d.id,":"),r.statusText)}m(e)}catch(e){console.error("Error fetching tiers for all services:",e)}};(0,t.useEffect)(()=>{R()},[]),(0,t.useEffect)(()=>{b.length>0&&I()},[b]);let U=e=>{F(e),w(!0)},D=(e,d)=>{F(e),_(d);let r=f[e][d];k.setFieldsValue({quality:r.quality,credit:r.credit}),v(!0)},O=()=>{w(!1),v(!1),k.resetFields()},L=(e,d)=>{let r=f[e].filter((e,r)=>r!==d);m(d=>({...d,[e]:r}))},Q=()=>{let e=[];for(let[d,r]of Object.entries(f)){let i=b.find(e=>e.id===d);i&&r.forEach(d=>{let r=parseInt(d.tier.replace("Tier ",""),10);e.push({PricingCategoryId:i.id,TierNumber:r,QualityRange:d.quality,CreditPerUnit:d.credit})})}return e},X=async()=>{let e=Q();console.log(e);try{let d=await fetch("".concat("http://192.168.0.104:5216/api","/tiers"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});d.ok?(x.oR.success("Tiers posted successfully!"),I()):x.oR.error(d.statusText)}catch(e){x.oR.error("An error occurred while posting data.")}};return(0,i.jsxs)(p.A,{children:[(0,i.jsx)(c.A,{title:"Service Pricing",children:(0,i.jsxs)("div",{style:{padding:"20px"},children:[(0,i.jsxs)(l.A,{showSearch:!0,placeholder:"Select a service",onChange:e=>{S(e),q&&N(!1)},style:{width:200,marginRight:10},filterOption:(e,d)=>{var r;return(null!==(r=null==d?void 0:d.children)&&void 0!==r?r:"").toLowerCase().includes(e.toLowerCase())},children:[(0,i.jsx)(g,{value:"",disabled:!0,children:"Select a service"}),b.map(e=>(0,i.jsx)(g,{value:e.id,children:e.pricingCategoryName},e.id))]}),(0,i.jsx)(n.Ay,{style:{marginLeft:"10px"},onClick:()=>{N(e=>{let d=!e;return d&&S(null),d})},children:q?"Hide All":"Show All"}),(0,i.jsx)(n.Ay,{type:"primary",onClick:X,style:{marginTop:"20px"},children:"Submit"}),T&&!q&&(0,i.jsx)("div",{style:{marginTop:"20px"},children:(0,i.jsx)(c.A,{title:(null===(e=b.find(e=>e.id===T))||void 0===e?void 0:e.pricingCategoryName)||T,children:(0,i.jsxs)("div",{style:{padding:"20px"},children:[(0,i.jsx)(n.Ay,{type:"primary",onClick:()=>U(T),children:"Add Tier"}),(0,i.jsx)("br",{}),(0,i.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",marginTop:"20px",textAlign:"center",border:"1px solid #ddd",borderRadius:"8px",overflow:"hidden",boxShadow:"rgb(0 0 0 / 23%) 5px 5px 10px 6px"},children:[(0,i.jsxs)("thead",{children:[(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{style:{border:"1px solid #ddd"}}),(0,i.jsx)("th",{colSpan:3,style:{border:"1px solid #ddd",padding:"8px",color:"white",background:"linear-gradient(90deg, rgb(0 79 155) 0%, rgb(0 79 155) 35%, rgba(0, 212, 255, 1) 100%)"},children:(null===(d=b.find(e=>e.id===T))||void 0===d?void 0:d.pricingCategoryName)||T})]}),(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{style:{border:"1px solid #ddd",padding:"8px",background:"linear-gradient(160deg, #0093E9 0%, #80D0C7 100%)"},children:"Tier"}),(0,i.jsx)("th",{style:{border:"1px solid #ddd",color:"white",padding:"8px",background:"linear-gradient(359deg, #8bd4ff 0%, #0015ff 100%)"},children:"Quality [Sensor]"}),(0,i.jsx)("th",{style:{border:"1px solid #ddd",color:"white",padding:"8px",background:"linear-gradient(359deg, #8bd4ff 0%, #0015ff 100%)"},children:"Credit per Unit/month"}),(0,i.jsx)("th",{style:{border:"1px solid #ddd",color:"white",padding:"8px",background:"linear-gradient(359deg, #8bd4ff 0%, #0015ff 100%)"},children:"Action"})]})]}),(0,i.jsx)("tbody",{children:(f[T]||[]).map((e,d)=>(0,i.jsxs)("tr",{style:{background:d%2==0?"linear-gradient(160deg, #e0f7fa 0%, #80deea 100%)":"linear-gradient(160deg, #ffebee 0%, #9ab8ef 100%)"},children:[(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px",background:"linear-gradient(160deg, #0093E9 0%, #80D0C7 100%)"},children:e.tier}),(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px"},children:e.quality}),(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px"},children:e.credit}),(0,i.jsxs)("td",{style:{border:"1px solid #ddd",padding:"8px"},children:[(0,i.jsx)(n.Ay,{type:"primary",onClick:()=>D(T,d),children:"Update"}),(0,i.jsx)(n.Ay,{type:"danger btn-danger",onClick:()=>L(T,d),style:{marginLeft:"10px"},children:"Delete"})]})]},d))})]})]})})}),q&&(0,i.jsx)("div",{style:{marginTop:"20px"},children:b.map(e=>(0,i.jsx)(c.A,{title:e.pricingCategoryName,children:(0,i.jsxs)("div",{style:{padding:"20px"},children:[(0,i.jsx)(n.Ay,{type:"primary",onClick:()=>U(e.id),children:"Add Tier"}),(0,i.jsx)("br",{}),(0,i.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",marginTop:"20px",textAlign:"center",border:"1px solid #ddd",borderRadius:"8px",overflow:"hidden",boxShadow:"rgb(0 0 0 / 23%) 5px 5px 10px 6px"},children:[(0,i.jsxs)("thead",{children:[(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{style:{border:"1px solid #ddd"}}),(0,i.jsx)("th",{colSpan:3,style:{border:"1px solid #ddd",padding:"8px",color:"white",background:"linear-gradient(90deg, rgb(0 79 155) 0%, rgb(0 79 155) 35%, rgba(0, 212, 255, 1) 100%)"},children:e.pricingCategoryName})]}),(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{style:{border:"1px solid #ddd",padding:"8px",background:"linear-gradient(160deg, #0093E9 0%, #80D0C7 100%)",color:"white"},children:"Tier"}),(0,i.jsx)("th",{style:{border:"1px solid #ddd",color:"white",padding:"8px",background:"linear-gradient(359deg, #8bd4ff 0%, #0015ff 100%)"},children:"Quality [Sensor]"}),(0,i.jsx)("th",{style:{border:"1px solid #ddd",color:"white",padding:"8px",background:"linear-gradient(359deg, #8bd4ff 0%, #0015ff 100%)"},children:"Credit per Unit/month"}),(0,i.jsx)("th",{style:{border:"1px solid #ddd",color:"white",padding:"8px",background:"linear-gradient(359deg, #8bd4ff 0%, #0015ff 100%)"},children:"Action"})]})]}),(0,i.jsx)("tbody",{children:(f[e.id]||[]).map((d,r)=>(0,i.jsxs)("tr",{style:{background:r%2==0?"linear-gradient(160deg, #e0f7fa 0%, #80deea 100%)":"linear-gradient(160deg, #ffebee 0%, #9ab8ef 100%)"},children:[(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px",background:"linear-gradient(160deg, #0093E9 0%, #80D0C7 100%)"},children:d.tier}),(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px"},children:d.quality}),(0,i.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px"},children:d.credit}),(0,i.jsxs)("td",{style:{border:"1px solid #ddd",padding:"8px"},children:[(0,i.jsx)(n.Ay,{type:"primary",onClick:()=>D(e.id,r),children:"Update"}),(0,i.jsx)(n.Ay,{type:"danger",className:"btn-danger",onClick:()=>L(e.id,r),style:{marginLeft:"10px"},children:"Delete"})]})]},r))})]})]})},e.id))})]})}),(0,i.jsx)(a.A,{title:"Add New Tier",visible:A,onCancel:O,footer:null,children:(0,i.jsxs)(s.A,{form:k,onFinish:e=>{let d=f[P]||[],r=d.length+1,i=[...d,{tier:"Tier ".concat(r),...e}];m(e=>({...e,[P]:i})),w(!1),k.resetFields()},children:[(0,i.jsx)(s.A.Item,{name:"quality",label:"Quality",rules:[{required:!0,message:"Please input the quality!"}],children:(0,i.jsx)(o.A,{})}),(0,i.jsx)(s.A.Item,{name:"credit",label:"Credit",rules:[{required:!0,message:"Please input the credit!"}],children:(0,i.jsx)(o.A,{})}),(0,i.jsx)(s.A.Item,{children:(0,i.jsx)(n.Ay,{type:"primary",htmlType:"submit",children:"Add Tier"})})]})}),(0,i.jsx)(a.A,{title:"Update Tier",visible:C,onCancel:O,footer:null,children:(0,i.jsxs)(s.A,{form:k,onFinish:e=>{let d=[...f[P]];d[E]={...d[E],quality:e.quality,credit:e.credit},m(e=>({...e,[P]:d})),v(!1),k.resetFields()},children:[(0,i.jsx)(s.A.Item,{name:"quality",label:"Quality",rules:[{required:!0,message:"Please input the quality!"}],children:(0,i.jsx)(o.A,{})}),(0,i.jsx)(s.A.Item,{name:"credit",label:"Credit",rules:[{required:!0,message:"Please input the credit!"}],children:(0,i.jsx)(o.A,{})}),(0,i.jsx)(s.A.Item,{children:(0,i.jsx)(n.Ay,{type:"primary",htmlType:"submit",children:"Update Tier"})})]})}),(0,i.jsx)(x.N9,{})]})}},6715:(e,d,r)=>{e.exports=r(8440)}},e=>{var d=d=>e(e.s=d);e.O(0,[994,1531,8331,3418,2453,5262,7239,2084,1106,8728,3067,6740,3093,3608,1609,636,6593,8792],()=>d(3525)),_N_E=e.O()}]);